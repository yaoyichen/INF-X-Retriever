<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1250 320">
  <defs>
    <!-- Drop Shadow Filter -->
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feGaussianBlur in="SourceAlpha" stdDeviation="4"/>
      <feOffset dx="2" dy="4" result="offsetblur"/>
      <feComponentTransfer>
        <feFuncA type="linear" slope="0.15"/>
      </feComponentTransfer>
      <feMerge> 
        <feMergeNode/>
        <feMergeNode in="SourceGraphic"/> 
      </feMerge>
    </filter>

    <!-- Gradients -->
    <linearGradient id="bg-gray" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ffffff;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#f8fafc;stop-opacity:1" />
    </linearGradient>

    <linearGradient id="card-blue" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f8fafc;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#eff6ff;stop-opacity:1" />
    </linearGradient>
    
    <linearGradient id="header-blue" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#3b82f6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#2563eb;stop-opacity:1" />
    </linearGradient>

    <linearGradient id="card-orange" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#fffbf5;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#fff7ed;stop-opacity:1" />
    </linearGradient>

    <linearGradient id="header-orange" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#f97316;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ea580c;stop-opacity:1" />
    </linearGradient>

    <linearGradient id="card-green" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f0fdf4;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#dcfce7;stop-opacity:1" />
    </linearGradient>

    <!-- Markers -->
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#64748b" />
    </marker>
    <marker id="arrowhead-blue" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#2563eb" />
    </marker>

    <!-- Common Styles -->
    <style>
      .title-main { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; font-size: 28px; font-weight: 800; fill: #1e293b; }
      .card-title { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; font-size: 16px; font-weight: 700; fill: #ffffff; }
      .card-subtitle { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; font-size: 14px; font-weight: 600; fill: #334155; }
      .card-text { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; font-size: 13px; fill: #475569; }
      .data-text { font-family: 'Monaco', 'Consolas', monospace; font-size: 12px; fill: #64748b; }
      .label-text { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; font-size: 12px; font-weight: 600; fill: #64748b; text-transform: uppercase; letter-spacing: 0.5px;}
      
      .path-line { fill: none; stroke: #cbd5e1; stroke-width: 2; marker-end: url(#arrowhead); }
      .path-line-active { fill: none; stroke: #bfdbfe; stroke-width: 3; marker-end: url(#arrowhead-blue); }
      
      .node-rect { stroke: #e2e8f0; stroke-width: 1; filter: url(#shadow); }
      .data-pill { fill: #ffffff; stroke: #cbd5e1; stroke-width: 1.5; rx: 16; filter: url(#shadow); }
    </style>
  </defs>

  <!-- Background -->
  <rect width="1250" height="450" fill="#ffffff"/>
  
  <!-- Main Title -->
  <text x="625" y="50" text-anchor="middle" class="title-main">INF-X-Retriever Architecture</text>

  <!-- LAYOUT GRID: 
       Y Center: 200
       X Positions: Query(100) -> Aligner(300) -> Aligned(500) -> Retriever(700) -> Docs(900) -> RAG(1100)
  -->

  <!-- 1. User Query Node -->
  <g transform="translate(50, 150)">
    <rect width="160" height="100" rx="12" fill="url(#bg-gray)" class="node-rect"/>
    <rect width="160" height="6" rx="3" fill="#94a3b8" y="0" clip-path="inset(0 0 95% 0)"/> <!-- Top accent -->
    <text x="80" y="35" text-anchor="middle" class="card-subtitle" style="font-size: 16px;">User Query</text>
    <line x1="20" y1="50" x2="140" y2="50" stroke="#e2e8f0" stroke-width="1"/>
    <text x="80" y="70" text-anchor="middle" class="card-text">Complex Instructions</text>
  </g>

  <!-- Arrow 1 -->
  <path d="M 210 200 L 250 200" class="path-line-active"/>

  <!-- 2. Query Aligner Node (CORE) -->
  <g transform="translate(250, 120)">
    <!-- Card Body -->
    <rect width="200" height="160" rx="12" fill="url(#card-blue)" class="node-rect" stroke="#bfdbfe"/>
    <!-- Header -->
    <path d="M 0 12 Q 0 0 12 0 L 188 0 Q 200 0 200 12 L 200 40 L 0 40 Z" fill="url(#header-blue)"/>
    <text x="100" y="26" text-anchor="middle" class="card-title">üîç Query Aligner</text>
    
    <!-- Content -->
    <text x="100" y="65" text-anchor="middle" class="card-subtitle">inf-query-aligner</text>
    <text x="100" y="85" text-anchor="middle" class="card-text" fill="#3b82f6">Reinforcement Learning</text>
    
    <line x1="20" y1="100" x2="180" y2="100" stroke="#bfdbfe" stroke-width="1" stroke-dasharray="4,4"/>
    
    <text x="100" y="125" text-anchor="middle" class="card-text">Intent Distillation</text>
    <text x="100" y="145" text-anchor="middle" class="card-text">Noise Elimination</text>
  </g>

  <!-- Arrow 2 -->
  <path d="M 450 200 L 490 200" class="path-line-active"/>

  <!-- 3. Aligned Query (Data Pill) -->
  <g transform="translate(490, 180)">
    <rect width="120" height="40" class="data-pill"/>
    <text x="60" y="25" text-anchor="middle" class="data-text" style="font-weight: bold; fill:#2563eb;">Aligned Query</text>
  </g>

  <!-- Arrow 3 -->
  <path d="M 610 200 L 650 200" class="path-line-active"/>

  <!-- 4. Retriever Node (CORE) -->
  <g transform="translate(650, 120)">
    <!-- Card Body -->
    <rect width="200" height="160" rx="12" fill="url(#card-orange)" class="node-rect" stroke="#fed7aa"/>
    <!-- Header -->
    <path d="M 0 12 Q 0 0 12 0 L 188 0 Q 200 0 200 12 L 200 40 L 0 40 Z" fill="url(#header-orange)"/>
    <text x="100" y="26" text-anchor="middle" class="card-title">üöÄ Retriever</text>
    
    <!-- Content -->
    <text x="100" y="65" text-anchor="middle" class="card-subtitle">inf-retriever-v1-pro</text>
    <text x="100" y="85" text-anchor="middle" class="card-text" fill="#f97316">Dense Embedding</text>
    
    <line x1="20" y1="100" x2="180" y2="100" stroke="#fed7aa" stroke-width="1" stroke-dasharray="4,4"/>
    
    <text x="100" y="125" text-anchor="middle" class="card-text">Long-query Adapt.</text>
    <text x="100" y="145" text-anchor="middle" class="card-text">Vector Search</text>
  </g>

  <!-- Arrow 4 -->
  <path d="M 850 200 L 890 200" class="path-line"/>

  <!-- 5. Top-k Docs (Data Pill) -->
  <g transform="translate(890, 180)">
    <rect width="120" height="40" class="data-pill"/>
    <text x="60" y="25" text-anchor="middle" class="data-text">Top-k Docs</text>
  </g>

  <!-- Arrow 5 (Dashed) -->
  <path d="M 1010 200 L 1050 200" class="path-line" stroke-dasharray="5,5"/>

  <!-- 6. Downstream Node -->
  <g transform="translate(1050, 150)">
    <rect width="160" height="100" rx="12" fill="url(#card-green)" class="node-rect" stroke="#bbf7d0"/>
    <rect width="160" height="6" rx="3" fill="#22c55e" y="0" clip-path="inset(0 0 95% 0)"/> <!-- Top accent -->
    <text x="80" y="35" text-anchor="middle" class="card-subtitle" style="font-size: 16px; fill: #15803d;">Downstream</text>
    <line x1="20" y1="50" x2="140" y2="50" stroke="#bbf7d0" stroke-width="1"/>
    <text x="80" y="70" text-anchor="middle" class="card-text">RAG / QA System</text>
    <text x="80" y="88" text-anchor="middle" class="card-text">LLM Synthesis</text>
  </g>


</svg>